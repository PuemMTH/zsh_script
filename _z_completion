#compdef z

_z() {
    local curcontext="$curcontext" state line
    typeset -A opt_args

    _arguments -C \
        '1: :->cmds' \
        '*:: :->args'

    case "$state" in
        cmds)
            local -a commands
            commands=(
                'add:Store a new command'
                'attach:Store a command silently'
                'list:List all stored commands'
                'ls:List all stored commands'
                'delete:Delete command by number'
                'clear:Clear all commands'
                'search:Search stored commands'
                'stats:Show statistics'
                'help:Show help message'
            )
            _describe -t commands 'z commands' commands
            ;;
        args)
            case "$words[1]" in
                add|attach)
                    _message "Enter command to store"
                    ;;
                delete)
                    # แสดงหมายเลขคำสั่งที่มีอยู่
                    if [ -f "$HOME/.z_commands" ]; then
                        local numbers
                        numbers=$(awk '{print NR}' "$HOME/.z_commands" | tr '\n' ' ')
                        _describe -t numbers 'command numbers' numbers
                    else
                        _message "No commands stored yet"
                    fi
                    ;;
                search)
                    _message "Enter search pattern"
                    ;;
            esac
            ;;
    esac
}

compdef _z z 